---
title: Understand and implement callback refs in React
description: Use callback refs to store DOM node's attributes as a variable(state | refs | memo)
date: 2023-07-24
category: React
---

# React callback ref

Refs are mutable containers where we can theoretically store any arbitrary values. Most of the times, they are used to get access to a DOM node.

```JavaScript
const inputRef = React.useRef(null)
return <input ref={ref} defaultValue="Hey there" />
```

React sets the DOM node in the ref after it was rendered and sets it back to _null_ when the component unmounts.

What if I want to focus an input element after the render? I could simply use `useEffect()` hook and focus on the element.

```JavaScript
React.useEffect(() => {
  inputRef.current?.focus()
}, [])
```

I can have an empty dependency since I only want to run this effect only once after the component was mounted.
After the component was rendered and the effect runs, we can have access to the input element in the DOM and focus it.

Well, this is _not_ the best way. It has some caveats in certain advanced situations.

> Specifically, it assumes that the ref is "filled" when the effect runs. If it's not available, e.g. because you pass the ref to a custom component which will defer the rendering or only show the input after some other user interaction, the content of the ref will still be null when the effect runs and nothing will be focussed:
>
> - TkDodo

```jsx
function App() {
  const ref = React.useRef(null)

  React.useEffect(() => {
    // ğŸš¨ ref.current is always null when this runs
    ref.current?.focus()
  }, [])

  return <Form ref={ref} />
}

const Form = React.forwardRef((props, ref) => {
  const [show, setShow] = React.useState(false)

  return (
    <form>
      <button type="button" onClick={() => setShow(true)}>
        show
      </button>
      // ğŸ§ ref is attached to the input, but it's conditionally rendered // so it
      won't be filled when the above effect runs
      {show && <input ref={ref} />}
    </form>
  )
})
```

When Form component renders, `input` is not rendered since it is set to `false` and _ref_ is still _null_.
Then effect runs, but it doesn't do anything. When `input` renders, _ref_ gets filled, but won't be focued since effect will not run again because effect isn't depdent on `show` state.
